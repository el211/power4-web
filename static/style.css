/* Power 4 — 100% Go (no JS) — Gamified + Levels + Inverse Gravity */

/* Glass variables (you can tweak the opacities) */
/* Power 4 — 100% Go (no JS) — Glass + bright background */

/* ===== Variables ===== */
:root{
    /* original palette */
    --bg:#0b0f1a;
    --surface:#0f172a;
    --card:#111827;
    --muted:#94a3b8;
    --text:#e5e7eb;
    --accent:#2563eb;
    --grid:#1f2937;
    --hole:#0b1220;
    --red:#ef4444;
    --yellow:#f59e0b;
    --btn:#0f172a;
    --btn-border:#1f2937;
    --btn-hover:#253045;
    --shadow:0 10px 30px rgba(0,0,0,.35);
    --invert-accent:#a855f7;

    /* glass layer */
    --glass: rgba(8,14,24,.38);
    --glass-strong: rgba(8,14,24,.52);
    --glass-border: rgba(255,255,255,.10);
    --glass-shadow: 0 10px 30px rgba(0,0,0,.25);
}

*{box-sizing:border-box}
html,body{height:100%}
html{scroll-behavior:smooth}
body{
    margin:0; color:var(--text);
    font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
    background:var(--bg);
    overflow-x:hidden;
}

/* ===== Background image (brighter) ===== */
.bg-layer{
    position:fixed; inset:0; z-index:-1;
    background:
            radial-gradient(1400px 700px at 70% -10%, rgba(18,33,60,.35) 0%, rgba(11,15,26,.45) 55%, transparent 100%),
            url('/static/bg.png') center/cover no-repeat;
    filter:saturate(1.12) brightness(1.12) contrast(1.03);
}

/* ===== Top Bar (glass) ===== */
.topbar{
    display:flex; align-items:center; justify-content:space-between;
    padding:16px 20px;
    background: var(--glass-strong);
    border-bottom:1px solid var(--glass-border);
    backdrop-filter: blur(10px) saturate(120%);
    -webkit-backdrop-filter: blur(10px) saturate(120%);
    position:sticky; top:0; z-index:10;
}
.topbar h1{margin:0; font-size:1.1rem; font-weight:700; letter-spacing:.3px}

/* ===== Controls / Inputs ===== */
.controls{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
select, button, input:not([type="radio"]):not([type="checkbox"]){
    appearance:none;
    background: rgba(15,23,42,.55); color:var(--text);
    border:1px solid var(--glass-border);
    padding:9px 12px; border-radius:10px; cursor:pointer;
    transition:border-color .15s ease, transform .06s ease, background .15s;
    font-weight:600;
}
input{cursor:text}
select:focus, button:focus, input:focus{outline:2px solid var(--accent); outline-offset:2px}
button:hover, select:hover{border-color:var(--accent)}
button:active{transform: translateY(1px)}
input[type="radio"],input[type="checkbox"]{appearance:auto; background:transparent; border:none; padding:0; width:auto; height:auto; cursor:pointer;}
.btn-primary{ background: rgba(37,99,235,.9); border-color: rgba(37,99,235,.9); color:#fff }
.btn-primary:hover{ filter:brightness(1.05) }
.btn-secondary{ background: rgba(12,20,38,.6); border-color: var(--glass-border); }
.btn-secondary:hover{ border-color: var(--accent) }

/* ===== Layout ===== */
.container{max-width:1000px; margin:28px auto; padding:0 16px}

/* status / card as glass */
.status, .card{
    display:flex; justify-content:space-between; align-items:center;
    background: var(--glass);
    border:1px solid var(--glass-border);
    border-radius:14px; padding:12px 16px;
    box-shadow: var(--glass-shadow);
    backdrop-filter: blur(10px) saturate(120%);
    -webkit-backdrop-filter: blur(10px) saturate(120%);
}
.card{ padding:18px; border-radius:16px }
.card.center{ text-align:center; display:block }
#score{display:flex; gap:18px; color:var(--muted)}
#playerLabel{font-weight:700}

/* notices (more transparent) */
.notice{
    background: rgba(15,23,42,.45);
    border:1px solid var(--glass-border);
    border-radius:12px; padding:10px 14px; margin:12px 0; color:#d1d5db;
}
.notice.invert{ background: rgba(43,16,72,.45); }

/* ===== Board ===== */
.board{
    margin:20px auto; display:grid; gap:10px;
    grid-template-columns: repeat(7, 1fr);
    width:min(96vw, 900px);
    padding:16px; border-radius:18px;
    background: rgba(10,16,28,.35);
    border:1px solid var(--glass-border);
    box-shadow: var(--glass-shadow);
}
.col{
    background: rgba(20,28,44,.42);
    border-radius:12px; padding:10px;
    display:grid; gap:10px; grid-template-rows: repeat(6, 1fr);
    position: relative;
}
.cell{
    width:100%; aspect-ratio:1/1; border-radius:50%;
    background:radial-gradient(60% 60% at 30% 30%, rgba(22,32,54,.85) 0%, rgba(10,14,24,.95) 100%);
    display:flex; align-items:center; justify-content:center;
    position:relative; overflow:hidden; border:1px solid #0e1628;
}

/* pieces */
.piece{
    width:88%; height:88%; border-radius:50%;
    box-shadow: inset 0 6px 10px rgba(255,255,255,.15), inset 0 -12px 20px rgba(0,0,0,.35), 0 2px 4px rgba(0,0,0,.25);
    animation: drop-in .5s cubic-bezier(.2,.8,.25,1) both;
}
.piece.red{    background:radial-gradient(circle at 35% 25%, #ff7676 0%, var(--red) 60%); }
.piece.yellow{ background:radial-gradient(circle at 35% 25%, #ffd777 0%, var(--yellow) 60%); }
.piece.block{  background: radial-gradient(circle at 35% 25%, #64748b 0%, #334155 60%); box-shadow: inset 0 4px 8px rgba(255,255,255,.08), inset 0 -8px 14px rgba(0,0,0,.35); animation:none;}

/* drop animation */
@keyframes drop-in{
    0%   { transform: translateY(-120%) scale(.92); opacity: .0; }
    65%  { transform: translateY(0)      scale(1.03); opacity: 1; }
    80%  { transform: translateY(-6%); }
    100% { transform: translateY(0)      scale(1); }
}
@media (prefers-reduced-motion: reduce){ .piece{ animation:none }}

/* winner highlight */
.winner{ outline:3px solid var(--accent); box-shadow:0 0 18px rgba(37,99,235,.4); }

/* column click area */
.col-form{ position:absolute; inset:0; }
.col-hit{
    position:absolute; inset:0; border:0; background:transparent; cursor:pointer; appearance:none;
}
.col-hit:hover{ outline:2px solid var(--btn-hover); outline-offset:-6px; border-radius:12px; }
.col-hit:disabled{ cursor:not-allowed; }

/* badges / footer */
.badge{
    display:inline-flex; align-items:center; gap:6px;
    background: rgba(15,23,42,.55);
    color:#d1d5db; border:1px solid var(--glass-border);
    padding:6px 10px; border-radius:999px; font-weight:600;
}
.footer{ color:#c2c8d4; text-align:center; padding:24px 12px; font-size:.92rem; background: transparent }

/* gravity inverse tint */
.gravity-inverse .bg-layer{ filter:hue-rotate(30deg) saturate(1.15) brightness(1.15); }
.gravity-inverse .winner{ outline-color: var(--invert-accent); box-shadow:0 0 18px rgba(168,85,247,.45); }

/* start form */
.start-form .row{ display:flex; gap:12px; align-items:center; margin:10px 0 }
.start-form label{ min-width:130px; color:#cbd5e1 }
.start-form input{ min-width:220px }
.start-form .inline{ display:flex; gap:12px; flex-wrap:wrap; align-items:center }

/* responsive */
@media (max-width: 720px){
    .status{flex-direction:column; gap:8px; align-items:flex-start}
    .board{gap:8px; padding:12px}
    .col{gap:8px; padding:8px}
}
@media (max-width: 420px){
    .topbar{padding:12px 14px}
    .topbar h1{font-size:1rem}
    .container{margin:18px auto}
    .board{width:95vw}
}

/* ensure click layer above pieces */
.col-form, .col-hit { position:absolute; inset:0; z-index:5; }
.col-hit{
    position:absolute; inset:0; border:0; background:transparent; cursor:pointer; appearance:none;
}
.col-hit:hover{ outline:2px solid var(--btn-hover); outline-offset:-6px; border-radius:12px; }
.col-hit:disabled{ cursor:not-allowed; }

/* Cards, notices */
.card{
    background:var(--surface); border:1px solid var(--btn-border);
    border-radius:16px; padding:18px; box-shadow: var(--shadow);
}
.card.center{ text-align:center }
.notice{
    background:rgba(15,23,42,.75); border:1px solid #1f2937;
    border-radius:12px; padding:10px 14px; margin:12px 0; color:#d1d5db;
}
.notice.invert{ border-color:#3b0764; color:#e9d5ff; }

/* start form */
.start-form .row{ display:flex; gap:12px; align-items:center; margin:10px 0 }
.start-form label{ min-width:130px; color:#cbd5e1 }
.start-form input{ min-width:220px }

/* badges / footer */
.badge{
    display:inline-flex; align-items:center; gap:6px;
    background:#0f172a; color:#d1d5db; border:1px solid #1f2937;
    padding:6px 10px; border-radius:999px; font-weight:600;
}
.footer{ color:#7b8393; text-align:center; padding:24px 12px; font-size:.92rem; }

/* gravité inversée: tint violet pour ressentir le switch */
.gravity-inverse .bg-layer{ filter:hue-rotate(30deg) saturate(1.1) brightness(.98); }
.gravity-inverse .notice{ border-color:#3b0764; }
.gravity-inverse .winner{ outline-color: var(--invert-accent); box-shadow:0 0 18px rgba(168,85,247,.45); }
.start-form .inline{ display:flex; gap:12px; flex-wrap:wrap; align-items:center }
.btn-primary{ background:var(--accent); border-color:var(--accent); color:white }
.btn-primary:hover{ filter:brightness(1.05) }
.btn-secondary{ background:#0c1426; border-color:var(--btn-border); }
.btn-secondary:hover{ border-color:var(--accent) }

/* responsive */
@media (max-width: 720px){
    .status{flex-direction:column; gap:8px; align-items:flex-start}
    .board{gap:8px; padding:12px}
    .col{gap:8px; padding:8px}
}
@media (max-width: 420px){
    .topbar{padding:12px 14px}
    .topbar h1{font-size:1rem}
    .container{margin:18px auto}
    .board{width:95vw}
}
.col-form, .col-hit {
    position: absolute;
    inset: 0;
    z-index: 5; /* ensure button covers pieces */
}
{{if .IsOnline}}
<!-- ===== Mini-Chat (en ligne) ===== -->
<aside class="chat-panel">
<div class="chat-header">💬 Chat de la salle <strong>{{.LobbyCode}}</strong></div>
<div id="chatList" class="chat-list" aria-live="polite"></div>

<form id="chatForm" class="chat-form" autocomplete="off">
<input type="text" id="chatInput" name="text" placeholder="Écrire un message…" maxlength="240" required>
<button type="submit" class="btn-primary">Envoyer</button>
</form>
</aside>
  {{end}}
/* ===== Mini-Chat (left sidebar) ===== */
.has-chat .container{
    /* make room for the sidebar on wide screens */
    margin-left: 360px;
}

/* Sidebar panel */
.chat-panel{
    position: fixed;
    left: 18px;
    top: 86px;                 /* just under the topbar */
    width: 320px;
    height: calc(100vh - 110px);
    display: flex;
    flex-direction: column;
    z-index: 20;

    background: var(--glass);
    border: 1px solid var(--glass-border);
    border-radius: 14px;
    backdrop-filter: blur(10px) saturate(120%);
    -webkit-backdrop-filter: blur(10px) saturate(120%);
    box-shadow: var(--glass-shadow);
}

/* Header */
.chat-header{
    padding: 10px 12px;
    border-bottom: 1px solid var(--glass-border);
    font-weight: 700;
}

/* Message list */
.chat-list{
    flex: 1;
    overflow-y: auto;
    padding: 10px 12px;
    display: grid;
    gap: 8px;
}

/* Message bubble */
.chat-item{
    padding: 8px 10px;
    border-radius: 10px;
    background: rgba(15,23,42,.55);
    border: 1px solid var(--glass-border);
    word-break: break-word;
    box-shadow: 0 2px 10px rgba(0,0,0,.12);
}

.chat-item.chat-r{ /* red player */
    border-left: 3px solid var(--red);
}
.chat-item.chat-y{ /* yellow player */
    border-left: 3px solid var(--yellow);
}

.chat-who{
    font-weight: 700;
    opacity: .95;
    margin-right: 6px;
}
.chat-text{
    opacity: .95;
}

/* Composer */
.chat-form{
    display: flex;
    gap: 8px;
    padding: 10px 12px;
    border-top: 1px solid var(--glass-border);
    background: rgba(8,14,24,.28);
    border-bottom-left-radius: 14px;
    border-bottom-right-radius: 14px;
}
.chat-form input{
    flex: 1;
    background: rgba(15,23,42,.55);
    border: 1px solid var(--glass-border);
    color: var(--text);
    padding: 9px 12px;
    border-radius: 10px;
}

/* Responsive: dock at bottom on small screens */
@media (max-width: 1100px){
    .has-chat .container{
        margin-left: 0;           /* no sidebar gap on narrow screens */
    }
    .chat-panel{
        left: 12px; right: 12px;
        width: auto;
        top: auto;
        bottom: 16px;
        height: 38vh;             /* compact “bottom sheet” */
    }
}
